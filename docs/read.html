---

title: nbprocess.read


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/00_read.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_read.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">time</span><span class="o">,</span><span class="nn">nbclient</span><span class="o">,</span><span class="nn">tempfile</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pformat</span><span class="p">,</span><span class="n">pprint</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reading-and-executing-notebooks">Reading and executing notebooks<a class="anchor-link" href="#Reading-and-executing-notebooks"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A notebook is just a json file:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">minimal_fn</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../tests/minimal.ipynb&#39;</span><span class="p">)</span>
<span class="n">minimal_txt</span> <span class="o">=</span> <span class="n">minimal_fn</span><span class="o">.</span><span class="n">read_json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="display_json" class="doc_header"><code>display_json</code><a href="https://github.com/fastai/nbprocess/tree/master/nbprocess/read.py#L17" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>display_json</code>(<strong><code>d</code></strong>)</p>
</blockquote>
<p>Formatter to reduce vertical space used by JSON display</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display_json</span><span class="p">(</span><span class="n">minimal_txt</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea output_execute_result">
<div class="highlight"><pre><span></span><span class="p">{</span> <span class="s1">&#39;cells&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span><span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;markdown&#39;</span><span class="p">,</span> <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;# A minimal notebook&#39;</span><span class="p">]},</span>
             <span class="p">{</span> <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span>
               <span class="s1">&#39;execution_count&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
               <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">},</span>
               <span class="s1">&#39;outputs&#39;</span><span class="p">:</span> <span class="p">[],</span>
               <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;# Do some arithmetic</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;1+1&#39;</span><span class="p">]}],</span>
  <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;kernelspec&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;display_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Python 3&#39;</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;python3&#39;</span><span class="p">},</span>
                <span class="s1">&#39;language_info&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;codemirror_mode&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ipython&#39;</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
                                   <span class="s1">&#39;file_extension&#39;</span><span class="p">:</span> <span class="s1">&#39;.py&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;mimetype&#39;</span><span class="p">:</span> <span class="s1">&#39;text/x-python&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;nbconvert_exporter&#39;</span><span class="p">:</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;pygments_lexer&#39;</span><span class="p">:</span> <span class="s1">&#39;ipython3&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;3.8.3&#39;</span><span class="p">}},</span>
  <span class="s1">&#39;nbformat&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
  <span class="s1">&#39;nbformat_minor&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
</pre></div>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The important bit for us is the <code>cells</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display_json</span><span class="p">(</span><span class="n">minimal_txt</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea output_execute_result">
<div class="highlight"><pre><span></span><span class="p">[</span> <span class="p">{</span><span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;markdown&#39;</span><span class="p">,</span> <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;# A minimal notebook&#39;</span><span class="p">]},</span>
  <span class="p">{</span> <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_count&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">},</span>
    <span class="s1">&#39;outputs&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;# Do some arithmetic</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;1+1&#39;</span><span class="p">]}]</span>
</pre></div>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The second cell here is a <code>code</code> cell, however it contains no outputs, because it hasn't been executed yet. To execute a notebook, we first need to convert it into a format suitable for <code>nbclient</code> (which expects some <code>dict</code> keys to be available as attrs, and some available as regular <code>dict</code> keys). Normally, <code>nbformat</code> is used for this step, but it's rather slow and inflexible, so we'll write our own function based on <code>fastcore</code>'s handy <code>dict2obj</code>, which makes all keys available as both attrs <em>and</em> keys.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NbCell" class="doc_header"><code>class</code> <code>NbCell</code><a href="https://github.com/fastai/nbprocess/tree/master/nbprocess/read.py#L23" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NbCell</code>(<strong><code>idx</code></strong>, <strong><code>cell</code></strong>) :: <code>AttrDict</code></p>
</blockquote>
<p><code>dict</code> subclass that also provides access to keys as attrs</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We use an <code>AttrDict</code> subclass which has some basic functionality for accessing notebook cells.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dict2nb" class="doc_header"><code>dict2nb</code><a href="https://github.com/fastai/nbprocess/tree/master/nbprocess/read.py#L41" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dict2nb</code>(<strong><code>js</code></strong>)</p>
</blockquote>
<p>Convert a dict to an <code>AttrDict</code>,</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now convert our JSON into this <code>nbclient</code>-compatible format...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">minimal</span> <span class="o">=</span> <span class="n">dict2nb</span><span class="p">(</span><span class="n">minimal_txt</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>...and execute it:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nbclient</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minimal</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One nice feature of the output of <a href="/nbprocess/read.html#dict2nb"><code>dict2nb</code></a> is that we can still use it as a <code>dict</code>, so <code>display_json</code> still works as before. We can see that the cell has been executed, and the output added back to the <code>nb</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cell</span> <span class="o">=</span> <span class="n">minimal</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre># Do some arithmetic
1+1
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display_json</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea output_execute_result">
<div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;output_type&#39;</span><span class="p">:</span> <span class="s1">&#39;execute_result&#39;</span><span class="p">,</span> <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;text/plain&#39;</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">},</span> <span class="s1">&#39;execution_count&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}]</span>
</pre></div>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The abstract syntax tree of source code cells is available in the <code>parsed_</code> property:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cell</span><span class="o">.</span><span class="n">parsed_</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">op</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;_ast.Add at 0x7fa0e7c78a90&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since loading JSON and converting to an NB is something we'll do a lot, we'll create a shortcut function for it:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_nb" class="doc_header"><code>read_nb</code><a href="https://github.com/fastai/nbprocess/tree/master/nbprocess/read.py#L48" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_nb</code>(<strong><code>path</code></strong>)</p>
</blockquote>
<p>Return notebook at <code>path</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">minimal</span> <span class="o">=</span> <span class="n">read_nb</span><span class="p">(</span><span class="n">minimal_fn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">minimal</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre># A minimal notebook
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Config">Config<a class="anchor-link" href="#Config"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>nbprocess uses a <code>settings.ini</code> file in the root of the project to store all configuration details. This file is in <code>ConfigParser</code> format, and can be read and written conveniently using fastcore's <code>Config</code> class.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="nbprocess_create_config" class="doc_header"><code>nbprocess_create_config</code><a href="https://github.com/fastai/nbprocess/tree/master/nbprocess/read.py#L53" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>nbprocess_create_config</code>(<strong><code>user</code></strong>:<code>str</code>, <strong><code>host</code></strong>:<code>str</code>=<em><code>'github'</code></em>, <strong><code>lib_name</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>path</code></strong>:<code>str</code>=<em><code>'.'</code></em>, <strong><code>cfg_name</code></strong>:<code>str</code>=<em><code>'settings.ini'</code></em>, <strong><code>branch</code></strong>:<code>str</code>=<em><code>'master'</code></em>, <strong><code>git_url</code></strong>:<code>str</code>=<em><code>'https://github.com/%(user)s/%(lib_name)s/tree/%(branch)s/'</code></em>, <strong><code>custom_sidebar</code></strong>:<code>bool_arg</code>=<em><code>False</code></em>, <strong><code>nbs_path</code></strong>:<code>str</code>=<em><code>'.'</code></em>, <strong><code>lib_path</code></strong>:<code>str</code>=<em><code>'%(lib_name)s'</code></em>, <strong><code>doc_path</code></strong>:<code>str</code>=<em><code>'docs'</code></em>, <strong><code>tst_flags</code></strong>:<code>str</code>=<em><code>''</code></em>, <strong><code>version</code></strong>:<code>str</code>=<em><code>'0.0.1'</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Creates a new config file for <code>lib_name</code> and <code>user</code> and saves it.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a wrapper for <code>fastcore</code>'s <code>save_config_file</code> which sets some <code>nbprocess</code> defaults. It is also installed as a CLI command.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_config" class="doc_header"><code>get_config</code><a href="https://github.com/fastai/nbprocess/tree/master/nbprocess/read.py#L81" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_config</code>(<strong><code>cfg_name</code></strong>=<em><code>'settings.ini'</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p><code>Config</code> for ini file found in <code>path</code> (defaults to <code>cwd</code>)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/nbprocess/read.html#get_config"><code>get_config</code></a> searches for <code>settings.ini</code> in the current directory, and then in all parent directories, stopping when it is found.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nbprocess_create_config</span><span class="p">(</span><span class="s1">&#39;fastai&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="n">nbs_path</span><span class="o">=</span><span class="s1">&#39;nbs&#39;</span><span class="p">,</span> <span class="n">tst_flags</span><span class="o">=</span><span class="s1">&#39;tst&#39;</span><span class="p">,</span> <span class="n">cfg_name</span><span class="o">=</span><span class="s1">&#39;test_settings.ini&#39;</span><span class="p">)</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">(</span><span class="s1">&#39;test_settings.ini&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">lib_name</span><span class="p">,</span> <span class="s1">&#39;nbprocess&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">git_url</span><span class="p">,</span> <span class="s2">&quot;https://github.com/fastai/nbprocess/tree/master/&quot;</span><span class="p">)</span>
<span class="n">cwd</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">config_path</span><span class="p">,</span> <span class="n">cwd</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="s1">&#39;lib_path&#39;</span><span class="p">),</span> <span class="n">cwd</span><span class="o">.</span><span class="n">parent</span><span class="o">/</span><span class="s1">&#39;nbprocess&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="s1">&#39;nbs_path&#39;</span><span class="p">),</span> <span class="n">cwd</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="s1">&#39;doc_path&#39;</span><span class="p">),</span> <span class="n">cwd</span><span class="o">.</span><span class="n">parent</span><span class="o">/</span><span class="s1">&#39;docs&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exporting-a-basic-module">Exporting a basic module<a class="anchor-link" href="#Exporting-a-basic-module"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_init" class="doc_header"><code>add_init</code><a href="https://github.com/fastai/nbprocess/tree/master/nbprocess/read.py#L93" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_init</code>(<strong><code>path</code></strong>)</p>
</blockquote>
<p>Add <code>__init__.py</code> in all subdirs of <code>path</code> containing python files if it's not there already</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Python modules require a <code>__init.py__</code> file in all directories that are modules. We assume that all directories containing a python file (including in subdirectories of any depth) is a module, and therefore add a <code>__init__.py</code> to each.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">d</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="s1">&#39;a/b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="s1">&#39;a/b/f.py&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">touch</span><span class="p">()</span>
    <span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="s1">&#39;a/c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>
    <span class="n">add_init</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="s1">&#39;a/c&#39;</span><span class="o">/</span><span class="n">_init</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">(),</span> <span class="s2">&quot;Should not add init to dir without py file&quot;</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="o">/</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">/</span><span class="s1">&#39;a/b&#39;</span><span class="p">]:</span> <span class="k">assert</span> <span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">_init</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">(),</span><span class="sa">f</span><span class="s2">&quot;Missing init in </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="write_cells" class="doc_header"><code>write_cells</code><a href="https://github.com/fastai/nbprocess/tree/master/nbprocess/read.py#L105" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>write_cells</code>(<strong><code>cells</code></strong>, <strong><code>hdr</code></strong>, <strong><code>file</code></strong>, <strong><code>offset</code></strong>=<em><code>0</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="basic_export_nb" class="doc_header"><code>basic_export_nb</code><a href="https://github.com/fastai/nbprocess/tree/master/nbprocess/read.py#L113" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>basic_export_nb</code>(<strong><code>fname</code></strong>, <strong><code>name</code></strong>, <strong><code>dest</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Basic exporter to bootstrap nbprocess</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a simple exporter with just enough functionality to correctly export this notebook, in order to bootstrap the creation of nbprocess itself.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../nbprocess&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;read.py&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">missing_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">add_init</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">basic_export_nb</span><span class="p">(</span><span class="s2">&quot;00_read.ipynb&quot;</span><span class="p">,</span> <span class="s1">&#39;read.py&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">nbprocess</span> <span class="kn">import</span> <span class="n">read</span>
<span class="k">assert</span> <span class="n">read</span><span class="o">.</span><span class="n">add_init</span>
<span class="k">assert</span> <span class="s1">&#39;add_init&#39;</span> <span class="ow">in</span> <span class="n">read</span><span class="o">.</span><span class="n">__all__</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

